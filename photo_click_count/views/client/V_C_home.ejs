<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <title>Cyborg - Awesome HTML5 Template</title>

    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-cyborg-gaming.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/animate.css">
    <link rel="stylesheet"href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
</head>

<div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <img src="" alt="Full Screen Image" id="rootImage">
            </div>
        </div>
    </div>
</div>

<script>
    async function viewImages(id,ImageUrl){
        document.getElementById('rootImage').src = ImageUrl;
        $('#imageModal').modal('show');

        const fomrData = new FormData();
        fomrData.append('albumId', id);

        const response = await fetch("/addView",{
            method: "POST",
            body: fomrData
        })

        const responseJson = await response.json();
    }
</script>


<body>

<div class="container">
    <div class="row">
      <div class="col-lg-12">
                <div class="most-popular">
                    <div class="row">
                    <div class="col-lg-12">
                        <div class="row" id="root">
                            <script>
                                async function fetchPhoto(){
                                    const response = await fetch('/photo_view',{
                                        method: 'GET',
                                        headers: {
                                            'Accept': 'application/json',
                                        }
                                    })
                                    const data = await response.json(); 
                                    if(data){
                                        let html = '';

                                        data.Total_view.map((data)=>{
                                            html += `<div class="col-lg-3 col-sm-6">
                                                        <div class="item">
                                                            <img src="http://localhost:3000/${data.photo_url}" alt="" height="200px" width="200px" onclick="viewImages('${data._id}','http://localhost:3000/${data.photo_url}')">
                                                        </div>
                                                    </div>`;  
                                        })
                                        document.getElementById('root').innerHTML = html;
                                    }
                                }

                                fetchPhoto();
                            </script>
                        </div>
                    </div>
                    </div>
                </div>
        </div>
    </div>
</div>


  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>
  <script src="assets/js/tabs.js"></script>
  <script src="assets/js/popup.js"></script>
  <script src="assets/js/custom.js"></script>


  </body>

</html>
